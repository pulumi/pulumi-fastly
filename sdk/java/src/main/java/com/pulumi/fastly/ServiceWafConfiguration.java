// *** WARNING: this file was generated by pulumi-java-gen. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

package com.pulumi.fastly;

import com.pulumi.core.Output;
import com.pulumi.core.annotations.Export;
import com.pulumi.core.annotations.ResourceType;
import com.pulumi.core.internal.Codegen;
import com.pulumi.fastly.ServiceWafConfigurationArgs;
import com.pulumi.fastly.Utilities;
import com.pulumi.fastly.inputs.ServiceWafConfigurationState;
import com.pulumi.fastly.outputs.ServiceWafConfigurationRule;
import com.pulumi.fastly.outputs.ServiceWafConfigurationRuleExclusion;
import java.lang.Boolean;
import java.lang.Integer;
import java.lang.String;
import java.util.List;
import java.util.Optional;
import javax.annotation.Nullable;

/**
 * Defines a set of Web Application Firewall configuration options that can be used to populate a service WAF. This resource will configure rules, thresholds and other settings for a WAF.
 * 
 * &gt; **Warning:** This provider will take precedence over any changes you make in the UI or API. Such changes are likely to be reversed if you run the provider again.
 * 
 * ## Adding a WAF to an existing service
 * 
 * &gt; **Warning:** A two-phase change is required when adding a WAF to an existing service
 * 
 * When adding a `waf` to an existing `fastly.ServiceVcl` and at the same time adding a `fastly.ServiceWafConfiguration`
 * resource with `waf_id = fastly_service_vcl.demo.waf[0].waf_id` might result with the in the following error:
 * 
 * &gt; fastly_service_vcl.demo.waf is empty list of object
 * 
 * For this scenario, it&#39;s recommended to split the changes into two distinct steps:
 * 
 * 1. Add the `waf` block to the `fastly.ServiceVcl` and apply the changes
 * 2. Add the `fastly.ServiceWafConfiguration` to the HCL and apply the changes
 * 
 * ## Import
 * 
 * This is an example of the import command being applied to the resource named `fastly_service_waf_configuration.waf` The resource ID should be the WAF ID.
 * 
 * ```sh
 *  $ pulumi import fastly:index/serviceWafConfiguration:ServiceWafConfiguration waf xxxxxxxxxxxxxxxxxxxx
 * ```
 * 
 */
@ResourceType(type="fastly:index/serviceWafConfiguration:ServiceWafConfiguration")
public class ServiceWafConfiguration extends com.pulumi.resources.CustomResource {
    /**
     * Conditionally prevents a new firewall version from being activated. The apply step will continue to create a new draft version but will not activate it if this is set to `false`. Default `true`
     * 
     */
    @Export(name="activate", type=Boolean.class, parameters={})
    private Output</* @Nullable */ Boolean> activate;

    /**
     * @return Conditionally prevents a new firewall version from being activated. The apply step will continue to create a new draft version but will not activate it if this is set to `false`. Default `true`
     * 
     */
    public Output<Optional<Boolean>> activate() {
        return Codegen.optional(this.activate);
    }
    /**
     * Whether a specific firewall version is currently deployed
     * 
     */
    @Export(name="active", type=Boolean.class, parameters={})
    private Output<Boolean> active;

    /**
     * @return Whether a specific firewall version is currently deployed
     * 
     */
    public Output<Boolean> active() {
        return this.active;
    }
    /**
     * Allowed HTTP versions
     * 
     */
    @Export(name="allowedHttpVersions", type=String.class, parameters={})
    private Output<String> allowedHttpVersions;

    /**
     * @return Allowed HTTP versions
     * 
     */
    public Output<String> allowedHttpVersions() {
        return this.allowedHttpVersions;
    }
    /**
     * A space-separated list of HTTP method names
     * 
     */
    @Export(name="allowedMethods", type=String.class, parameters={})
    private Output<String> allowedMethods;

    /**
     * @return A space-separated list of HTTP method names
     * 
     */
    public Output<String> allowedMethods() {
        return this.allowedMethods;
    }
    /**
     * Allowed request content types
     * 
     */
    @Export(name="allowedRequestContentType", type=String.class, parameters={})
    private Output<String> allowedRequestContentType;

    /**
     * @return Allowed request content types
     * 
     */
    public Output<String> allowedRequestContentType() {
        return this.allowedRequestContentType;
    }
    /**
     * Allowed request content type charset
     * 
     */
    @Export(name="allowedRequestContentTypeCharset", type=String.class, parameters={})
    private Output<String> allowedRequestContentTypeCharset;

    /**
     * @return Allowed request content type charset
     * 
     */
    public Output<String> allowedRequestContentTypeCharset() {
        return this.allowedRequestContentTypeCharset;
    }
    /**
     * The maximum number of arguments allowed
     * 
     */
    @Export(name="argLength", type=Integer.class, parameters={})
    private Output<Integer> argLength;

    /**
     * @return The maximum number of arguments allowed
     * 
     */
    public Output<Integer> argLength() {
        return this.argLength;
    }
    /**
     * The maximum allowed argument name length
     * 
     */
    @Export(name="argNameLength", type=Integer.class, parameters={})
    private Output<Integer> argNameLength;

    /**
     * @return The maximum allowed argument name length
     * 
     */
    public Output<Integer> argNameLength() {
        return this.argNameLength;
    }
    /**
     * The latest cloned firewall version by the provider
     * 
     */
    @Export(name="clonedVersion", type=Integer.class, parameters={})
    private Output<Integer> clonedVersion;

    /**
     * @return The latest cloned firewall version by the provider
     * 
     */
    public Output<Integer> clonedVersion() {
        return this.clonedVersion;
    }
    /**
     * The maximum allowed size of all files
     * 
     */
    @Export(name="combinedFileSizes", type=Integer.class, parameters={})
    private Output<Integer> combinedFileSizes;

    /**
     * @return The maximum allowed size of all files
     * 
     */
    public Output<Integer> combinedFileSizes() {
        return this.combinedFileSizes;
    }
    /**
     * Score value to add for critical anomalies
     * 
     */
    @Export(name="criticalAnomalyScore", type=Integer.class, parameters={})
    private Output<Integer> criticalAnomalyScore;

    /**
     * @return Score value to add for critical anomalies
     * 
     */
    public Output<Integer> criticalAnomalyScore() {
        return this.criticalAnomalyScore;
    }
    /**
     * CRS validate UTF8 encoding
     * 
     */
    @Export(name="crsValidateUtf8Encoding", type=Boolean.class, parameters={})
    private Output<Boolean> crsValidateUtf8Encoding;

    /**
     * @return CRS validate UTF8 encoding
     * 
     */
    public Output<Boolean> crsValidateUtf8Encoding() {
        return this.crsValidateUtf8Encoding;
    }
    /**
     * Score value to add for error anomalies
     * 
     */
    @Export(name="errorAnomalyScore", type=Integer.class, parameters={})
    private Output<Integer> errorAnomalyScore;

    /**
     * @return Score value to add for error anomalies
     * 
     */
    public Output<Integer> errorAnomalyScore() {
        return this.errorAnomalyScore;
    }
    /**
     * A space-separated list of country codes in ISO 3166-1 (two-letter) format
     * 
     */
    @Export(name="highRiskCountryCodes", type=String.class, parameters={})
    private Output<String> highRiskCountryCodes;

    /**
     * @return A space-separated list of country codes in ISO 3166-1 (two-letter) format
     * 
     */
    public Output<String> highRiskCountryCodes() {
        return this.highRiskCountryCodes;
    }
    /**
     * HTTP violation threshold
     * 
     */
    @Export(name="httpViolationScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> httpViolationScoreThreshold;

    /**
     * @return HTTP violation threshold
     * 
     */
    public Output<Integer> httpViolationScoreThreshold() {
        return this.httpViolationScoreThreshold;
    }
    /**
     * Inbound anomaly threshold
     * 
     */
    @Export(name="inboundAnomalyScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> inboundAnomalyScoreThreshold;

    /**
     * @return Inbound anomaly threshold
     * 
     */
    public Output<Integer> inboundAnomalyScoreThreshold() {
        return this.inboundAnomalyScoreThreshold;
    }
    /**
     * Local file inclusion attack threshold
     * 
     */
    @Export(name="lfiScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> lfiScoreThreshold;

    /**
     * @return Local file inclusion attack threshold
     * 
     */
    public Output<Integer> lfiScoreThreshold() {
        return this.lfiScoreThreshold;
    }
    /**
     * The maximum allowed file size, in bytes
     * 
     */
    @Export(name="maxFileSize", type=Integer.class, parameters={})
    private Output<Integer> maxFileSize;

    /**
     * @return The maximum allowed file size, in bytes
     * 
     */
    public Output<Integer> maxFileSize() {
        return this.maxFileSize;
    }
    /**
     * The maximum number of arguments allowed
     * 
     */
    @Export(name="maxNumArgs", type=Integer.class, parameters={})
    private Output<Integer> maxNumArgs;

    /**
     * @return The maximum number of arguments allowed
     * 
     */
    public Output<Integer> maxNumArgs() {
        return this.maxNumArgs;
    }
    /**
     * Score value to add for notice anomalies
     * 
     */
    @Export(name="noticeAnomalyScore", type=Integer.class, parameters={})
    private Output<Integer> noticeAnomalyScore;

    /**
     * @return Score value to add for notice anomalies
     * 
     */
    public Output<Integer> noticeAnomalyScore() {
        return this.noticeAnomalyScore;
    }
    /**
     * The WAF firewall version
     * 
     */
    @Export(name="number", type=Integer.class, parameters={})
    private Output<Integer> number;

    /**
     * @return The WAF firewall version
     * 
     */
    public Output<Integer> number() {
        return this.number;
    }
    /**
     * The configured paranoia level
     * 
     */
    @Export(name="paranoiaLevel", type=Integer.class, parameters={})
    private Output<Integer> paranoiaLevel;

    /**
     * @return The configured paranoia level
     * 
     */
    public Output<Integer> paranoiaLevel() {
        return this.paranoiaLevel;
    }
    /**
     * PHP injection threshold
     * 
     */
    @Export(name="phpInjectionScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> phpInjectionScoreThreshold;

    /**
     * @return PHP injection threshold
     * 
     */
    public Output<Integer> phpInjectionScoreThreshold() {
        return this.phpInjectionScoreThreshold;
    }
    /**
     * Remote code execution threshold
     * 
     */
    @Export(name="rceScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> rceScoreThreshold;

    /**
     * @return Remote code execution threshold
     * 
     */
    public Output<Integer> rceScoreThreshold() {
        return this.rceScoreThreshold;
    }
    /**
     * A space-separated list of allowed file extensions
     * 
     */
    @Export(name="restrictedExtensions", type=String.class, parameters={})
    private Output<String> restrictedExtensions;

    /**
     * @return A space-separated list of allowed file extensions
     * 
     */
    public Output<String> restrictedExtensions() {
        return this.restrictedExtensions;
    }
    /**
     * A space-separated list of allowed header names
     * 
     */
    @Export(name="restrictedHeaders", type=String.class, parameters={})
    private Output<String> restrictedHeaders;

    /**
     * @return A space-separated list of allowed header names
     * 
     */
    public Output<String> restrictedHeaders() {
        return this.restrictedHeaders;
    }
    /**
     * Remote file inclusion attack threshold
     * 
     */
    @Export(name="rfiScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> rfiScoreThreshold;

    /**
     * @return Remote file inclusion attack threshold
     * 
     */
    public Output<Integer> rfiScoreThreshold() {
        return this.rfiScoreThreshold;
    }
    @Export(name="ruleExclusions", type=List.class, parameters={ServiceWafConfigurationRuleExclusion.class})
    private Output</* @Nullable */ List<ServiceWafConfigurationRuleExclusion>> ruleExclusions;

    public Output<Optional<List<ServiceWafConfigurationRuleExclusion>>> ruleExclusions() {
        return Codegen.optional(this.ruleExclusions);
    }
    @Export(name="rules", type=List.class, parameters={ServiceWafConfigurationRule.class})
    private Output</* @Nullable */ List<ServiceWafConfigurationRule>> rules;

    public Output<Optional<List<ServiceWafConfigurationRule>>> rules() {
        return Codegen.optional(this.rules);
    }
    /**
     * Session fixation attack threshold
     * 
     */
    @Export(name="sessionFixationScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> sessionFixationScoreThreshold;

    /**
     * @return Session fixation attack threshold
     * 
     */
    public Output<Integer> sessionFixationScoreThreshold() {
        return this.sessionFixationScoreThreshold;
    }
    /**
     * SQL injection attack threshold
     * 
     */
    @Export(name="sqlInjectionScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> sqlInjectionScoreThreshold;

    /**
     * @return SQL injection attack threshold
     * 
     */
    public Output<Integer> sqlInjectionScoreThreshold() {
        return this.sqlInjectionScoreThreshold;
    }
    /**
     * The maximum size of argument names and values
     * 
     */
    @Export(name="totalArgLength", type=Integer.class, parameters={})
    private Output<Integer> totalArgLength;

    /**
     * @return The maximum size of argument names and values
     * 
     */
    public Output<Integer> totalArgLength() {
        return this.totalArgLength;
    }
    /**
     * The ID of the Web Application Firewall that the configuration belongs to
     * 
     */
    @Export(name="wafId", type=String.class, parameters={})
    private Output<String> wafId;

    /**
     * @return The ID of the Web Application Firewall that the configuration belongs to
     * 
     */
    public Output<String> wafId() {
        return this.wafId;
    }
    /**
     * Score value to add for warning anomalies
     * 
     */
    @Export(name="warningAnomalyScore", type=Integer.class, parameters={})
    private Output<Integer> warningAnomalyScore;

    /**
     * @return Score value to add for warning anomalies
     * 
     */
    public Output<Integer> warningAnomalyScore() {
        return this.warningAnomalyScore;
    }
    /**
     * XSS attack threshold
     * 
     */
    @Export(name="xssScoreThreshold", type=Integer.class, parameters={})
    private Output<Integer> xssScoreThreshold;

    /**
     * @return XSS attack threshold
     * 
     */
    public Output<Integer> xssScoreThreshold() {
        return this.xssScoreThreshold;
    }

    /**
     *
     * @param name The _unique_ name of the resulting resource.
     */
    public ServiceWafConfiguration(String name) {
        this(name, ServiceWafConfigurationArgs.Empty);
    }
    /**
     *
     * @param name The _unique_ name of the resulting resource.
     * @param args The arguments to use to populate this resource's properties.
     */
    public ServiceWafConfiguration(String name, ServiceWafConfigurationArgs args) {
        this(name, args, null);
    }
    /**
     *
     * @param name The _unique_ name of the resulting resource.
     * @param args The arguments to use to populate this resource's properties.
     * @param options A bag of options that control this resource's behavior.
     */
    public ServiceWafConfiguration(String name, ServiceWafConfigurationArgs args, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        super("fastly:index/serviceWafConfiguration:ServiceWafConfiguration", name, args == null ? ServiceWafConfigurationArgs.Empty : args, makeResourceOptions(options, Codegen.empty()));
    }

    private ServiceWafConfiguration(String name, Output<String> id, @Nullable ServiceWafConfigurationState state, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        super("fastly:index/serviceWafConfiguration:ServiceWafConfiguration", name, state, makeResourceOptions(options, id));
    }

    private static com.pulumi.resources.CustomResourceOptions makeResourceOptions(@Nullable com.pulumi.resources.CustomResourceOptions options, @Nullable Output<String> id) {
        var defaultOptions = com.pulumi.resources.CustomResourceOptions.builder()
            .version(Utilities.getVersion())
            .build();
        return com.pulumi.resources.CustomResourceOptions.merge(defaultOptions, options, id);
    }

    /**
     * Get an existing Host resource's state with the given name, ID, and optional extra
     * properties used to qualify the lookup.
     *
     * @param name The _unique_ name of the resulting resource.
     * @param id The _unique_ provider ID of the resource to lookup.
     * @param state
     * @param options Optional settings to control the behavior of the CustomResource.
     */
    public static ServiceWafConfiguration get(String name, Output<String> id, @Nullable ServiceWafConfigurationState state, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        return new ServiceWafConfiguration(name, id, state, options);
    }
}
